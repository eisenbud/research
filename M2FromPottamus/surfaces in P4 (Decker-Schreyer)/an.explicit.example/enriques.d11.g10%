set echo 1
 
; Appendix A. An Explicit Computation In Macaulay 



	
	; We present the Macaulay program for the Enriques surface (2.5) including some 
	; of the Macaulay output. The program is written using the commands of Macaulay 
	; only. You may abbreviate the presentation of the program by using some of the
	; scripts of David Eisenbud.	

	; On a Sun SPARCstation 2 the program will need about 85 minutes time and a bit more 
        ; than 16 MB of the main memory. On a smaller machine one has to cut the program into 
	; convenient parts, to store the results in-between and to be more patient.
	

set showmem 1
set timer 1
	

	; Following Barth, Hulek and Moore [BHM] we consider elliptic normal curves of 
 ; degree 5 in P4 which are	(H,i)-equivariantly embedded:
	; Let x[0], ..., x[4] be the homogeneous coordinates on P4 and consider
	; Bring's plane

	;          P2+ =  x[1]-x[4] = x[2]-x[3] = 0  c P4
	
 ; with coordinates x[0], x[1], x[2]. According to Barth-Hulek-Moore elliptic
	; normal curves as above together with a nontrivial 2-torsion point correspond 
	; to points on Bring's curve
	
	;          B c P2+
	
	; defined by
	
	;          x[0]4x[1]x[2]-x[0]2x[1]2x[2]2-x[0](x[1]5+x[2]5)+2x[1]3x[2]3 = 0. 
	
    ; We pick the point
	
	;          p = (y:1:1) e B
	
	
	; and consider the corresponding elliptic curve E. E is defined over the ring
	; of integers O of the number field 
	
 ;          K = Q[y] = Q[x]/(x2+2x+2). 
	
	; Let q be a prime in O over 17. Then 
	
	;          O/q = F17
	
	; and 

 ;          (y:1:1) = (3:1:1) mod 17. 
	
	; By the openness of smoothness it suffices to check that we get a smooth 
	; surface of the desired type over F17.
	; (H,i)-equivariantly embedded elliptic normal curves in P4 are defined 
	; by an ideal generated by five quadrics 

 ;          Qi = s2x[i+2]x[i+3]+stx[i]2-t2x[i+1]x[i+4] with i e Z/5
	
 ; and (s:t) e P1. For our elliptic curve E we have
	
	;          (s:t) = (4:1) mod 17.
	


	;                 A.1. An elliptic normal curve E c P4




ring r
17
5
x[0]-x[4]
;
; 


imap sigma r r
x[0] x[4]
x[1] x[0]
x[2] x[1]
x[3] x[2]
x[4] x[3]
;

poly q0 16x[2]x[3]+4x[0]2-x[1]x[4]
ev sigma q0 q4
ev sigma q4 q3
ev sigma q3 q2
ev sigma q2 q1
copy q0 E
concat E q1 q2 q3 q4
res E fE
 
betti fE

; total:      1     5     5     1 
; --------------------------------
;     0:      1     -     -     - 
;     1:      -     5     5     - 
;     2:      -     -     -     1

hilb fE.1

 ; codimension = 3
 ; degree      = 5
 ; genus       = 1

jacob E dE
wedge dE 3 min
flatten min singE
concat singE E
std singE singE

codim singE

 ; codimension : 5
 
   
	   
    ;Thus E is a smooth elliptic normal curve of degree 5 in P4.
    
	

	; Next we determine: 
	

	
	;    A.2. The two other elliptic normal curves E' and E" which are
	;              2-sections of the same quintic elliptic scroll Q           	


	; Consider the conic

 	;          C+ =  x[0]2+4x[1]x[2] = 0  c P2+

    ; parametrized by (s:t) -- (2st:-t2:s2). The image points of (s':t') and (s":t")
    ; corresponding to E' and E" span a line L in P2+. L is the polar to p = (y:1:1) 
    ; with respect to C+. Thus  
	
	;          L =  6x[0]+4x[1]+4x[2] = 0  mod 17 	
 
    ; and 
	
	;           (s':t') = (1:14), (s":t") = (1:6) mod 17.
	
	; Consequently


poly q0' x[2]x[3]+14x[0]2-9x[1]x[4]
ev sigma q0' q4'
ev sigma q4' q3'
ev sigma q3' q2'
ev sigma q2' q1'
copy q0' E'
concat E' q1' q2' q3' q4'
poly q0'' x[2]x[3]+6x[0]2-2x[1]x[4]
ev sigma q0'' q4''
ev sigma q4'' q3''
ev sigma q3'' q2''
ev sigma q2'' q1''
copy q0'' E''
concat E'' q1'' q2'' q3'' q4''


    ; gives E' and E". (As for E one can check that E' and E'' are indeed smooth
  	 ; elliptic normal curves of degree 5 in P4.)



	 ;                 A.3.The quintic elliptic scroll Q which contains all     
	 ;                                       three elliptic curves                     




intersect E' E'' Q
betti Q

; total:      1    15 
; --------------------
;     0:      1     - 
;     1:      -     - 
;     2:      -     5 
;     3:      -    10

submat Q Q
1
1..5
res Q fQ
betti fQ

; total:      1     5     5     1 
; --------------------------------
;     0:      1     -     -     - 
;     1:      -     -     -     - 
;     2:      -     5     5     1 

hilb fQ.1

 ; codimension = 2
 ; degree      = 5
 ; genus       = 1



 
    ; Thus Q is the desired elliptic quintic scroll. E c Q  since


	
copy E EcQ
concat EcQ Q
res EcQ fEcQ
betti fEcQ
 
; total:      1    10    10     1 
; --------------------------------
;     0:      1     -     -     - 
;     1:      -     5    10     - 
;     2:      -     5     -     1

    ; Q is indeed smooth since
 


jacob Q dQ
wedge dQ 2 min
flatten min singQ
concat singQ Q
std singQ singQ
codim singQ
 
 ; codimension : 5

 


    
	   ;      A.4. J = IE'+IE" is the desired H1-module

 


copy E' J
concat J E''
dshift J 2
res J fJ
hilb fJ.1
 
;       1 t  2
;       5 t  3
;       5 t  4
 
 
betti fJ
 
; total:      1    10    25    31    20     5 
; --------------------------------------------
;     2:      1     -     -     -     -     - 
;     3:      -    10    15     5     -     - 
;     4:      -     -    10    26    20     5


 

   	;    A.5. A morphism phi e Hom(F,G) chosen at random    
   	;                       and the ideal IX                

	 


random 5 2 rd
submat fJ.3 a
1..15
1..5
mult a rd ard
transpose ard dra
res dra fdra 2
betti fdra
 
; total:      2    15    25 
; --------------------------
;    -7:      -     -     5 
;    -6:      2    15    20  

 
submat fdra.2 b
1..15
1..5
transpose b bt
res bt fbt
betti fbt

; total:      5    15    10 
; --------------------------
;     3:      -     -    10 
;     4:      -    15     - 
;     5:      5     -     -  


submat fJ.2 c
1..10
1..15
mult c fbt.2 d
trans d dt
res dt fdt 2
betti fdt
 
; total:     10    10     2 
; --------------------------
;    -5:     10    10     - 
;    -4:      -     -     1 
;    -3:      -     -     - 
;    -2:      -     -     1 

submat fdt.2 e
1..10
2
trans e et
mult et fJ.2 IX
std IX IX
hilb IX

 ; codimension = 2
 ; degree      = 11
 ; genus       = 10

res IX fIX
betti fIX
 
 ; total:      1    15    29    20     5 
; --------------------------------------
;     0:      1     -     -     -     - 
;     1:      -     -     -     -     - 
;     2:      -     -     -     -     - 
;     3:      -     -     -     -     - 
;     4:      -     5     3     -     - 
;     5:      -    10    26    20     5 





    ;Thus IX is the ideal of a surface X with the desired invariants.   

	 


    ; Next we check:   




    ;                         A.6. The smoothness of X

	
 
	
	; In principle this can be done as follows:
	;   jacob IX dIX
	;   wedge dIX 2 min
	;   flatten min singX
	;   concat singX IX
	;   std singX singX
	;   codim singX
	
	;    ; codimension : 5
		
	; To save memory and time, we avoid to compute all the 2x2 minors of dIX:
 

 	
jacob IX dIX
flatten dIX entries
std entries entries
codim entries
 
 ; codimension : 5

 


    ; Hence X has at most hypersurface singularities.
    ; We consider one quintic H5 containing X:
 

	
submat IX H5
1
1
jacob H5 dH5
flatten dH5 dH5
concat dH5 IX
std dH5 dH5
deg dH5

 ; codimension : 4
 ; degree      : 86

 
 
 ; Since X has at most hypersurface singularities, the normal bundle (IX/IX2)* is 
 ; locally free. H5 gives a section of (IX/IX2)(5), which vanishes as expected 
 ; along a subscheme of length
	
 ;      86 = c2((IX/IX2)(5)) .
 	
 ; Next we prove that X is singular in at most these points by computing 
 ; sufficently many minors of dIX, which involve H5.
 

 
betti dIX
 
; total:     15     5 
; --------------------
;    -6:     10     - 
;    -5:      5     - 
;    -4:      -     - 
;    -3:      -     - 
;    -2:      -     5 
 
submat dIX a2
1 2
1..5
wedge a2 2 min
flatten min sing
concat sing IX

submat dIX a3
1 3
1..5
wedge a3 2 min
flatten min min
concat sing min

submat dIX a4
1 4
1..5
wedge a4 2 min
flatten min min
concat sing min

submat dIX a5
1 5
1..5
wedge a5 2 min
flatten min min
concat sing min

std sing sing
deg sing

 ; codimension : 3
 ; degree      : 20
 
submat dIX a6
1 6
1..5
wedge a6 2 min
flatten min min
concat sing min

submat dIX a11
1 11
1..5
wedge a11 2 min
flatten min min
concat sing min

std sing sing
deg sing
 
 ; codimension : 4
 ; degree      : 86
 
 

    ; Hence X is singular at most in the 86 points as above. It follows that there is a 
    ; Zariski dense open subset U of the quintics containing X such that for any H5 e U
    ; the singular points of H5 contain the singular points of X. Hence X is singular at 
    ; most in the common zeroes of all the partial	derivatives of all the quintics. 
    ; This set is empty: 	




submat IX I5
1
1..5
jacob I5 dI5
flatten dI5 entries
std entries entries
codim entries

 ; codimension : 5

	
	
	;Hence X is smooth.
	

	
    ; Finally we analyse, how X fits into: 

	
	
	;                 A.7. The Enriques-Kodaira classification


		
	
res I5 fI5
hilb fI5.1

 ; codimension = 2
 ; degree      = 16
 ; genus       = 30

betti fI5

; total:      1     5     4 
; --------------------------
;     0:      1     -     - 
;     1:      -     -     - 
;     2:      -     -     - 
;     3:      -     -     - 
;     4:      -     5     3 
;     5:      -     -     1


 
    ; So the intersection of the quintics containing X is an arithmetically 
    ; Cohen-Macaulay surface of degree 16. 
	
	;          V(I5) = X u Q , 
		
	; since X u Q c V(I5) and both varieties have the same degree. 
	; Q c V(I5) holds because


	
copy Q QcV
concat QcV I5
res QcV fQcV
betti fQcV

; total:      1    10    10     1 
; --------------------------------
;     0:      1     -     -     - 
;     1:      -     -     -     - 
;     2:      -     5     5     1 
;     3:      -     -     5     - 
;     4:      -     5     -     -

  
    ; As checked above XuQ has only hypersurface singularities.In particular 
    ; the canonical sheaf of XuQ is invertible. The intersection
		
	;           D = X n Q 
		
	; is a smooth curve of degree 20 and numerical class
		
    ;           D = 6H-10f   on   Q,
		
	; where H denotes the hyperplane class and f the ruling. Indeed:



copy IX D
concat D Q
std D D
betti D

; total:      1    15 
; --------------------
;     0:      1     - 
;     1:      -     - 
;     2:      -     5 
;     3:      -     - 
;     4:      -     - 
;     5:      -    10 
 
hilb D

 ; codimension = 3
 ; degree      = 20
 ; genus       = 26


 
     ; To check the smoothness of D we just compute enough minors of the 
     ; jacobi matrix, e.g.:


	 
jacob D dD
betti dD

; total:     15     5 
; --------------------
;    -6:     10     - 
;    -5:      -     - 
;    -4:      -     - 
;    -3:      5     - 
;    -2:      -     5 


submat dD dDs
6..15
1..5
random 3 10 rdl
random 5 3 rdr
mult rdl dDs dDss
mult dDss rdr dDss
wedge dDss 3 singD
concat singD D
std singD singD
deg singD

 ; codimension : 4
 ; degree      : 300

random 3 10 rdl
random 5 3 rdr
mult rdl dDs dDss
mult dDss rdr dDss
wedge dDss 3 min
concat singD min
std singD singD
codim singD

 ; codimension : 5

submat D H6
1
6
concat H6 Q
quotient H6 D tenlines
hilb tenlines

 ; codimension = 3
 ; degree      = 10
 ; genus       = -9



   ; Thus Q is the union of all 6-secant lines to X. 
   
  
   ;In particular there are infinitely many 6-secants.
   

   ; The 5x3 submatrix of linear entries of the presentation of IXuQ defines
   ; an effective divisor 
 	
   ;          C' e   K-2H   on XuQ:


     
submat fI5.2 c
1..5
1..3
wedge c 3 C'
flatten C' C'
std C' C'
hilb C'

 ; codimension = 3
 ; degree      = 10
 ; genus       = 6



    ;           C' = U Li u E, 
	
	; where L1,...,L5 are (-1)-lines on X, and E is the elliptic curve with 
	; which we started the construction:


	
quotient C' E C
hilb C

 ; codimension = 3
 ; degree      = 5
 ; genus       = -4
 
power C 2 twoC
concat twoC IX
std twoC twoC
hilb twoC

 ; codimension = 3
 ; degree      = 10
 ; genus       = -14

 

     ; (The genus formula for C = U Li and 2C on X allows to compute C2 and C.K.)
     ; C e   K-2H+D   as a divisor on X. 
 

  
betti C

; total:      1    11 
; --------------------
;     0:      1     - 
;     1:      -     1 
;     2:      -    10

submat C R
1
1
concat R IX



    ; R is a divisor of class 2H on X. To compute 
	
	
	
	;                          p2 = h0(2K) = 1 
	
	
	
	; we consider the divisor 2D+R on X. Since 
		
	;          2K-2C = 6H-2D-R 
		
	; it suffices to check that the curve 2D+R lies on one more sextic than X:


	
power Q 2 twoD
concat twoD IX
std twoD twoD
betti twoD
intersect twoD R twoDplusR
betti twoDplusR

; total:      1    24 
; --------------------
;     0:      1     - 
;     1:      -     - 
;     2:      -     - 
;     3:      -     - 
;     4:      -     5 
;     5:      -    10 
;     6:      -     5 
;     7:      -     4
 
betti IX

; total:      1    15 
; --------------------
;     0:      1     - 
;     1:      -     - 
;     2:      -     - 
;     3:      -     - 
;     4:      -     5 
;     5:      -    10 
 
poly x2 x[0]2
quotient twoDplusR x2 sat
betti sat

; total:      1    20 
; --------------------
;     0:      1     - 
;     1:      -     - 
;     2:      -     - 
;     3:      -     - 
;     4:      -     5 
;     5:      -    11 
;     6:      -     1 
;     7:      -     3 

 
deg twoDplusR

 ; codimension : 3
 ; degree      : 62
 
deg sat

 ; codimension : 3
 ; degree      : 62


 
    ; Since 2D+R and the curve defined by "sat" have the same degree and 
    ; codimension they coincide. Since "sat" is contained in one more sextic than
    ; X, the divisor 2K-2C = 6H-R-D is effective.
	
	
  
	  ;Hence X is an Enriques surface.
	  
	
	
      ; More precisely the reduction mod q of X is a smooth Enriques surface. But 
      ; then also the fiber over the generic point of Spec O is a smooth Enriques 
      ; surface. 
	
  
	   
      ; We conclude:


      
      ;     X is an Enriques surface blown up in 6 points, embedded by   
      ;                                                                   
      ;                 	H = Hmin - 2E1 - L1 ... - L5.                       



      ; This could be the end of our program. But for the fun of it we will explicitely
      ; carry through the adjunction process for X.
      ; So far the time elapsed is about 60 minutes and we used almost 11 MB of the main 
      ; memory. One may save both time and memory by computing syzygies more carefully 
      ; ( see the corresponding scripts of David Eisenbud ). In what follows we will at
      ; least make use of the Macaulay flags autocalc and autodegree.
 



	
	;                 A.8. The adjunction process for X

	 

betti fIX
 
; total:      1    15    29    20     5 
; --------------------------------------
;     0:      1     -     -     -     - 
;     1:      -     -     -     -     - 
;     2:      -     -     -     -     - 
;     3:      -     -     -     -     - 
;     4:      -     5     3     -     - 
;     5:      -    10    26    20     5  

set autocalc 1
set autodegree -5
transpose fIX.3 b
res b fb 3
betti fb

; total:     20    29    25    20 
; --------------------------------
;    -8:     20    26    10     - 
;    -7:      -     3     5     - 
;    -6:      -     -    10    20

submat fb.3 w
16..25
1..20
set autocalc -1
std w w
hilb w
 
; codimension = 2
; degree      = 11
; genus       = -8

 

 ; w is a presentation matrix for the dualizing sheaf wX = Ext2(OX, wP4). We now 
 ; compute the image of X and of some hyperplanes under the linear system  H+K  .
 


ring rs
17
5+10
x[0]-x[4]y[0]-y[9]
;
;
fetch w w
submat rs y
1
6..15
mult y w yw
poly x4 x[4]
set autocalc 1
set autodegree 2
quotient yw x4 j
imap h0 rs rs
x[0] 0
;
imap h1 rs rs
x[1] 0
;
imap h2 rs rs
x[2] 0
;
ev h0 yw yw0
ev h1 yw yw1
ev h2 yw yw2
quotient yw0 x4 j0
quotient yw1 x4 j1
quotient yw2 x4 j2
set autocalc -1

ring r
17
10
y[0]-y[9]
;
;
fetch j j
fetch j0 j0
fetch j1 j1
fetch j2 j2
std j j
hilb j
 
;       1 t  0
;       7 t  1
;      11 t  2

; codimension = 7
; degree      = 19
; genus       = 11

betti j
 
; total:      1    17 
; --------------------
;     0:      1     - 
;     1:      -    17 



; The degree and the sectional genus have the predicted value.Hence j is the ideal 
; of the first adjoint surface X' in P9.Notice that j defines an arithmetically Cohen-Macaulay
; surface and is generated by quadrics as predicted by the general theory, cf. [EL].
 
;	Next we compute the images of the hyperplane	sections

;          H0 =  x[0] = 0 , ..., H2 =  x[2] = 0 : 


std j0 j0
hilb j0
 
;       1 t  0
;       8 t  1
;       8 t  2
;       1 t  3

; codimension = 8
; degree      = 18
; genus       = 10


betti j0
 
; total:      1    28 
; --------------------
;     0:      1     - 
;     1:      -    28 



;Hence the image of H0 is indeed a canonical curve.



copy j0 points
concat points j1
std points points
deg points
 
; codimension : 9
; degree      : 16

 

; Hence the images of H0 and H1 intersect in 16 = 11 + 5 points.It follows once 
; more that there are 5 exceptional lines blown down by the first adjunction mapping.

; The corresponding 5 points are: 
 


concat points j2
std points points
deg points

; codimension : 9
; degree      : 5

 


; Next we compute the second adjoint surface. Since the rank of the syzygies of j
; is quite large we do not use 

;          wX' = Extcodim(OX',wP9) 

; to compute a presentation of the dualizing sheaf wX'. Instead we use	
 
;          wX' = HomOP2(OX',wP2)	

; where X' -- P2 is a finite projection. 

 

k-basis j kbasis2
2
2
betti kbasis2
 
; total:      1    38 
; --------------------
;     0:      1     - 
;     1:      -    38

submat r param
1
8..10
type param
 
; y[7] y[8] y[9] 

copy param artin
concat artin j
std artin artin
hilb artin
k-basis artin kbasis2art
2
2
betti kbasis2art
 
; total:      1    11 
; --------------------
;     0:      1     - 
;     1:      -    11 

 

 ; Contraction with the elements of kbasis2art will give a generating set of wX'
 ; as OP9-module.
 


ring rr
17
10+11+38
y[0]-y[9]b[1]-b[11]a[1]-a[38]
;
;
submat rr y
1
1..10
submat rr b
1
11..21
submat rr a
1
22..59
fetch kbasis2 z
transpose a at
mult z at za
fetch j j
fetch kbasis2art kbasis2art
std j j
mult za y zay
reduce j zay zay
contract kbasis2art zay m
betti m
 
; total:     11    10 
; --------------------
;     2:     11     - 
;     3:      -    10 

flatten m flatm
set autocalc 1
set autodegree 1
res flatm ff 2
betti ff
 
; total:      1   110    70 
; --------------------------
;     0:      1     -    70 
;     1:      -   110     - 

set autocalc -1   
trans b bt
mult bt y bty
flatten bty n
mult n ff.2 q
jacob q dq b[1]..b[11]
trans dq w
betti w 
 
; total:     11    70 
; --------------------
;     1:     11    70  
 

setring r
fetch w w
std w w
hilb w

;      11 t  1
;       7 t  2
;       1 t  3

; codimension = 7
; degree      = 19
 


;Hence w is a presentation of the dualizing sheaf of the first adjoint surface.


 
; We are now ready to compute the second adjoint surface.
 


ring rs
17
10+11
y[0]-y[9]z[0]-z[10]
;
;
submat rs z
1
11..21
fetch w w
mult z w zw
betti zw
imap m0 rs rs
y[0] 0
;
imap m1 rs rs
y[1] 0
;
imap m2 rs rs
y[2] 0
;
poly y9 y[9]
set autocalc 1
set autodegree 2
ev m0 w w0
ev m1 w w1
ev m2 w w2
ev m0 zw zw0
ev m1 zw zw1
ev m2 zw zw2
quotient zw y9 jj
quotient zw0 y9 jj0
quotient zw1 y9 jj1
quotient zw2 y9 jj2

ring r
17
11
z[0]-z[10]
;
;
set autocalc -1
fetch jj jj
fetch jj0 jj0
fetch jj1 jj1
fetch jj2 jj2
std jj1 jj1
hilb jj1
 
;       1 t  0
;       9 t  1
;       9 t  2
;       1 t  3

; codimension = 9
; degree      = 20
; genus       = 11

 

;Hence jj1 is indeed a canonical curve.
 


std jj jj
hilb jj
 
;       1 t  0
;       8 t  1
;      11 t  2

; codimension = 8
; degree      = 20
; genus       = 11

 

;Again these are the predicted invariants, hence jj is the homogenous ideal 
;of the second adjoint surface.
 

;	Finally we check once more that the second adjunction mapping blows down precisely one curve:
 

concat jj1 jj0
std jj1 jj01
deg jj01
 

; codimension : 10
; degree      : 20

 

concat jj01 jj2
std jj01 jj012
deg jj012
 
; codimension : 10
; degree      : 1

 

;This is the image point of the exceptional curve of the  second adjunction mapping.

;So once more we see that we have	an Enriques surface of the type claimed.


